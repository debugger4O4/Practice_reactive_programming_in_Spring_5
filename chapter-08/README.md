## Глава 8: Масштабирование с помощью облачных потоков

### Облачный поток
это пример приложения чата, которое полностью отделено и готово к запуску в облаке. Ниже приведены шаги, необходимые для подготовки этого образца:

#### Подготовка MongoDB

Проект использует [MongoDB](https://www.mongodb.com/) в качестве основной базы данных для запроса и хранения всех данных.

Есть два доступных варианта установки MongoDB:

##### (Вариант 1) Докеризованная MongoDB

> Обратите внимание: этот вариант требует глубокого понимания [интерфейса командной строки Docker] (https://docs.docker.com/engine/reference/commandline/cli/).

> Прежде чем запускать эту опцию, убедитесь, что [Docker](https://docs.docker.com/install/) (уже установлен на локальном компьютере).

Для запуска образа MongoDB в контейнере Docker необходимо выполнить в терминале следующую команду:

``` Ш.
docker run --name test-mongo -p 27017:27017 -d mongo
```

##### (Вариант 2) Сервер MongoDB локального сообщества

Существует возможность установить MongoDB локально. Вся необходимая информация, связанная с локальной установкой, доступна по следующей [ссылке](https://www.mongodb.com/download-center?jmp=nav#community).

#### Подготовка RabbitMQ

Для этого проект использует [RabbitMQ](https://www.rabbitmq.com/) в качестве брокера сообщений.
пример

Есть два доступных варианта установки RabbitMQ:

##### (Вариант 1) Докеризованный RabbitMQ

> Обратите внимание: этот вариант требует глубокого понимания [интерфейса командной строки Docker] (https://docs.docker.com/engine/reference/commandline/cli/).

> Прежде чем запускать эту опцию, убедитесь, что [Docker](https://docs.docker.com/install/) (уже установлен на локальном компьютере).

Для запуска образа MongoDB в контейнере Docker необходимо выполнить в терминале следующую команду:

``` Ш.
docker run --name test-rabbit -p 4369:4369 -p 5671:5671 -p 5672:5672 -p 25672:25672 -d RabbitMQ
```

##### (Вариант 2) Сервер MongoDB локального сообщества

Существует возможность установить RabbitMQ локально. Вся необходимая информация, связанная с
локальная установка доступна по следующей [ссылке](http://www.rabbitmq.com/download.html).



#### Подготовка среды

Для правильного запуска проекта требуются соответствующие переменные среды/свойства YAML. Ниже приведен список доступных свойств/переменных среды *Spring Framework*:

| Свойства Spring                   | Переменная среды | Описание |
|-----------------------------------| -------------------- | ----------- |
| `gitter.auth.token`               | `GITTER_TOKEN` | Токен личного доступа, который можно использовать для доступа к API Gitter. | 
| `gitter.api.endpoint`             | - | Адрес общедоступной конечной точки REST API Gitter. Значение по умолчанию — [https://api.gitter.im/](https://api.gitter.im/). Чтобы узнать больше, [см. следующую документацию по API](https://developer.gitter.im/docs/rest-api) |
| `gitter.api.version`              | - | Версия Gitter REST API. Значение по умолчанию — `v1`. |
| `gitter.api.messages-resource`    | `GITTER_ROOM` | Путь к ресурсу сообщений. **Примечание**: в случае с переменной среды нет необходимости определять весь путь, поскольку он уже определен следующим образом: `rooms/${GITTER_ROOM}/chatMessages`. Чтобы получить идентификатор созданной комнаты Gitter, пожалуйста, [см. документацию API](https://developer.gitter.im/docs/rooms-resource#list-rooms). |
| `gitter.stream.endpoint`          | - | Адрес общедоступной конечной точки API Gitter Streaming. Значение по умолчанию — [https://stream.gitter.im/](https://stream.gitter.im/). Чтобы узнать больше, [см. следующую документацию по API](https://developer.gitter.im/docs/streaming-api) |
| `gitter.stream.version`           | - | Версия API потоковой передачи Gitter. Значение по умолчанию — `v1`. |
| `gitter.stream.messages-resource` | `GITTER_ROOM` | Путь к ресурсу сообщений. **Примечание**: в случае с переменной среды нет необходимости определять весь путь, поскольку он уже определен следующим образом: `rooms/${GITTER_ROOM}/chatMessages`. Чтобы получить идентификатор созданной комнаты Gitter, пожалуйста, [см. документацию API](https://developer.gitter.im/docs/rooms-resource#list-rooms). |